{
  "id": "01-micrograd-ex009",
  "lectureId": "01-micrograd",
  "segmentId": "01-micrograd-seg08",
  "title": "Implement tanh for Value",
  "difficulty": "easy",
  "order": 9,
  "topics": ["value-class", "activation-functions"],
  "description": "Add a `tanh()` method to Value that computes the hyperbolic tangent: `tanh(x) = (e^(2x) - 1) / (e^(2x) + 1)`.\n\nReturn a new Value with `_op='tanh'` and correct children.",
  "starterCode": "import math\n\nclass Value:\n    def __init__(self, data, _children=(), _op=''):\n        self.data = data\n        self.grad = 0.0\n        self._children = set(_children)\n        self._op = _op\n\n    def __repr__(self):\n        return f\"Value(data={self.data}, grad={self.grad})\"\n\n    def __add__(self, other):\n        other = other if isinstance(other, Value) else Value(other)\n        out = Value(self.data + other.data, (self, other), '+')\n        return out\n\n    def __mul__(self, other):\n        other = other if isinstance(other, Value) else Value(other)\n        out = Value(self.data * other.data, (self, other), '*')\n        return out\n\n    def tanh(self):\n        # TODO: compute hyperbolic tangent of self.data\n        # tanh(x) = (e^(2x) - 1) / (e^(2x) + 1)\n        # Return a new Value with _op='tanh' and (self,) as children\n        pass",
  "solutionCode": "import math\n\nclass Value:\n    def __init__(self, data, _children=(), _op=''):\n        self.data = data\n        self.grad = 0.0\n        self._children = set(_children)\n        self._op = _op\n\n    def __repr__(self):\n        return f\"Value(data={self.data}, grad={self.grad})\"\n\n    def __add__(self, other):\n        other = other if isinstance(other, Value) else Value(other)\n        out = Value(self.data + other.data, (self, other), '+')\n        return out\n\n    def __mul__(self, other):\n        other = other if isinstance(other, Value) else Value(other)\n        out = Value(self.data * other.data, (self, other), '*')\n        return out\n\n    def tanh(self):\n        x = self.data\n        t = (math.exp(2 * x) - 1) / (math.exp(2 * x) + 1)\n        out = Value(t, (self,), 'tanh')\n        return out",
  "testCode": "try:\n    v = Value(0.0)\n    result = v.tanh()\n    assert abs(result.data - 0.0) < 1e-4\n    print(\"PASS: tanh(0) is approximately 0\")\nexcept:\n    print(\"FAIL: tanh(0) is approximately 0\")\n\ntry:\n    v = Value(1.0)\n    result = v.tanh()\n    assert abs(result.data - 0.7616) < 1e-4\n    print(\"PASS: tanh(1) is approximately 0.7616\")\nexcept:\n    print(\"FAIL: tanh(1) is approximately 0.7616\")\n\ntry:\n    v = Value(-1.0)\n    result = v.tanh()\n    assert abs(result.data - (-0.7616)) < 1e-4\n    print(\"PASS: tanh(-1) is approximately -0.7616\")\nexcept:\n    print(\"FAIL: tanh(-1) is approximately -0.7616\")\n\ntry:\n    v = Value(1.0)\n    result = v.tanh()\n    assert result._op == 'tanh'\n    print(\"PASS: _op is 'tanh'\")\nexcept:\n    print(\"FAIL: _op is 'tanh'\")\n\ntry:\n    v = Value(1.0)\n    result = v.tanh()\n    assert v in result._children\n    print(\"PASS: self is in children of result\")\nexcept:\n    print(\"FAIL: self is in children of result\")",
  "hints": [
    "tanh(x) = (e^(2x) - 1) / (e^(2x) + 1)",
    "Don't forget to import math",
    "Return Value(t, (self,), 'tanh')"
  ]
}
